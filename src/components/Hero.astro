---
---
<!-- Hero Section with Scroll-Driven Layer Stacking Animation -->
<section class="relative min-h-[200vh] flex items-center justify-center px-4 sm:px-6 lg:px-8 bg-[radial-gradient(#06b6d412_1px,transparent_1px)] bg-[size:24px_24px]" id="hero-section">
	<div class="max-w-6xl 2xl:max-w-7xl mx-auto w-full">
		<div class="text-center mb-12 sm:mb-16 md:mb-20">
			<!-- Logo Layers Stacking Animation -->
			<div class="relative h-64 sm:h-80 md:h-96 mb-8 sm:mb-12 flex items-center justify-center" id="layer-container">
				<!-- Layer 1: $0 Credited Consultation (bottom layer) -->
				<div class="absolute layer-card" data-layer="1" id="layer-1">
					<div class="bg-[var(--bg-card)]/90 backdrop-blur-xl border border-[var(--stroke)] rounded-2xl p-6 sm:p-8 md:p-10 shadow-2xl w-[280px] sm:w-[320px] md:w-[360px] transition-colors duration-300">
						<div class="text-slate-600 dark:text-slate-400 font-mono text-xs sm:text-sm mb-2 uppercase tracking-wider">Phase 1</div>
						<div class="text-slate-800 dark:text-slate-300 text-lg sm:text-xl font-semibold mb-2">$0 Credited Consultation</div>
						<div class="text-slate-600 dark:text-slate-400 text-sm sm:text-base font-mono">Requirements Mapping</div>
						<p class="text-xs sm:text-sm text-slate-600 dark:text-slate-400 mt-3 leading-relaxed">
							Initial consultation fees are credited toward your final project cost when you proceed. Requirements analysis and project specifications.
						</p>
					</div>
				</div>
				
				<!-- Layer 2: Fixed-Price MVP Development (middle layer) -->
				<div class="absolute layer-card" data-layer="2" id="layer-2">
					<div class="bg-[var(--bg-card)]/90 backdrop-blur-xl border border-blue-500/30 rounded-2xl p-6 sm:p-8 md:p-10 shadow-2xl shadow-blue-500/10 w-[280px] sm:w-[320px] md:w-[360px] transition-colors duration-300">
						<div class="text-blue-600 dark:text-blue-400 font-mono text-xs sm:text-sm mb-2 uppercase tracking-wider">Phase 2</div>
						<div class="text-slate-900 dark:text-slate-200 text-lg sm:text-xl font-semibold mb-2">Fixed-Price MVP Development</div>
						<div class="text-blue-600 dark:text-blue-400 text-sm sm:text-base font-mono">Predictable Pricing</div>
						<p class="text-xs sm:text-sm text-slate-600 dark:text-slate-400 mt-3 leading-relaxed">
							Minimum Viable Product with clear deliverables, three revision rounds, and defined scope. Complete MVPs with timelines and budgets.
						</p>
						<div class="mt-4 pt-3 border-t border-blue-500/20 dark:border-blue-500/20">
							<div class="text-xs text-blue-600 dark:text-blue-400 font-semibold">✓ 60-Day Post-Launch Support Included</div>
						</div>
					</div>
				</div>
				
				<!-- Layer 3: Hourly Production Scaling & 60-Day Support (top layer) -->
				<div class="absolute layer-card" data-layer="3" id="layer-3">
					<div class="bg-[var(--bg-card)]/90 backdrop-blur-xl border border-cyan-500/30 rounded-2xl p-6 sm:p-8 md:p-10 shadow-2xl shadow-cyan-500/10 w-[280px] sm:w-[320px] md:w-[360px] transition-colors duration-300">
						<div class="text-cyan-600 dark:text-cyan-400 font-mono text-xs sm:text-sm mb-2 uppercase tracking-wider">Phase 3</div>
						<div class="text-slate-900 dark:text-slate-200 text-lg sm:text-xl font-semibold mb-2">Hourly Production Scaling</div>
						<div class="text-cyan-600 dark:text-cyan-400 text-sm sm:text-base font-mono">Ongoing Enhancements</div>
						<p class="text-xs sm:text-sm text-slate-600 dark:text-slate-400 mt-3 leading-relaxed">
							Ongoing maintenance, feature enhancements, and iterative development beyond MVP scope. Hourly rates for scaling and support.
						</p>
						<div class="mt-4 pt-3 border-t border-cyan-500/20 dark:border-cyan-500/20">
							<div class="text-xs text-cyan-600 dark:text-cyan-400 font-semibold">✓ 60-Day Support + Optional Retainers</div>
						</div>
					</div>
				</div>
			</div>

			<h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl 2xl:text-8xl font-extrabold tracking-tight mb-4 sm:mb-6 leading-tight font-sans transition-colors duration-300">
				<span class="text-[var(--text-header)]">Engineering the Web's</span> <span class="text-cyan-600 dark:text-cyan-400 relative inline-block">
					<span class="relative z-10">First Layer</span>
					<span class="absolute inset-0 bg-gradient-to-r from-cyan-400/20 to-cyan-500/20 blur-2xl -z-0"></span>
				</span>
			</h1>
			
			<p class="text-lg sm:text-xl md:text-2xl lg:text-2xl 2xl:text-3xl text-slate-600 dark:text-slate-400 mb-8 sm:mb-10 md:mb-12 leading-relaxed max-w-3xl 2xl:max-w-4xl mx-auto px-2 font-sans transition-colors duration-300">
				Maryland-based engineering firm specializing in <span class="text-slate-800 dark:text-slate-300 font-semibold">Digital Transformation</span> and <span class="text-slate-800 dark:text-slate-300 font-semibold">Custom Systems Design</span>.<br class="hidden sm:block" />
				<span class="text-slate-700 dark:text-slate-300 font-medium">Fast, secure, and built for growth.</span>
			</p>

			<div class="flex flex-col sm:flex-row justify-center items-stretch sm:items-center gap-3 sm:gap-4 mb-12 sm:mb-16 px-2">
				<a href="/contact" class="bg-cyan-500 text-slate-950 px-6 sm:px-8 py-3.5 sm:py-4 md:py-4 rounded-xl font-semibold text-base sm:text-lg hover:bg-cyan-400 active:bg-cyan-600 transition-all duration-300 shadow-lg shadow-cyan-500/30 hover:shadow-xl hover:shadow-cyan-500/40 hover:-translate-y-0.5 active:translate-y-0 touch-manipulation min-h-[44px] sm:min-h-[48px] flex items-center justify-center font-sans">
					Start Your Project
				</a>
				<a href="/work" class="bg-[var(--bg-card)]/80 backdrop-blur-sm text-[var(--text-header)] border-2 border-[var(--stroke)] px-6 sm:px-8 py-3.5 sm:py-4 md:py-4 rounded-xl font-semibold text-base sm:text-lg hover:bg-[var(--bg-card)] hover:border-cyan-500/60 active:bg-[var(--bg-card)] transition-all duration-300 shadow-md hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0 touch-manipulation min-h-[44px] sm:min-h-[48px] flex items-center justify-center font-sans">
					See My Work
				</a>
			</div>
		</div>
	</div>
</section>

<script>
	import { gsap } from 'gsap';
	import { ScrollTrigger } from 'gsap/ScrollTrigger';
	
	// Register ScrollTrigger plugin
	gsap.registerPlugin(ScrollTrigger);
	
	function initLayerStackingAnimation() {
		console.log('Initializing layer stacking animation...');
		
		// Check if GSAP is loaded
		if (typeof gsap === 'undefined') {
			console.error('GSAP is not loaded');
			return;
		}
		
		const heroSection = document.getElementById('hero-section');
		const layerContainer = document.getElementById('layer-container');
		
		if (!heroSection) {
			console.error('Hero section not found');
			return;
		}
		
		if (!layerContainer) {
			console.error('Layer container not found');
			return;
		}
		
		const layer1 = document.getElementById('layer-1');
		const layer2 = document.getElementById('layer-2');
		const layer3 = document.getElementById('layer-3');
		
		if (!layer1 || !layer2 || !layer3) {
			console.error('One or more layers not found', { layer1: !!layer1, layer2: !!layer2, layer3: !!layer3 });
			return;
		}
		
		console.log('All elements found, setting up animation...');
		
		// Kill any existing ScrollTriggers to prevent duplicates
		ScrollTrigger.getAll().forEach(trigger => {
			if (trigger.trigger === heroSection) {
				trigger.kill();
			}
		});
		
		// Set initial spread positions (layers start apart)
		// Use xPercent and yPercent for proper centering, then offset with x/y
		gsap.set(layer1, {
			transformOrigin: 'center center',
			xPercent: -50,
			yPercent: -50,
			x: -150,
			y: -40,
			z: 20,
			scale: 1.0,
			opacity: 1,
			zIndex: 1,
			visibility: 'visible',
		});
		
		gsap.set(layer2, {
			transformOrigin: 'center center',
			xPercent: -50,
			yPercent: -50,
			x: 0,
			y: -20,
			z: 10,
			scale: 1.0,
			opacity: 1,
			zIndex: 2,
			visibility: 'visible',
		});
		
		gsap.set(layer3, {
			transformOrigin: 'center center',
			xPercent: -50,
			yPercent: -50,
			x: 150,
			y: -40,
			z: 20,
			scale: 1.0,
			opacity: 1,
			zIndex: 3,
			visibility: 'visible',
		});
		
		// Create a timeline for the stacking animation
		// As user scrolls, layers move from spread positions to stacked positions
		const tl = gsap.timeline({
			scrollTrigger: {
				trigger: heroSection,
				start: 'top top',
				end: '+=100%', // End after scrolling 100% of viewport height
				scrub: 1.5,
				pin: true,
				pinSpacing: true,
				markers: false, // Set to true for debugging
				onUpdate: (self) => {
					console.log('Scroll progress:', self.progress.toFixed(2));
				},
			},
		});
		
		// Animate layers stacking together (from spread to stacked)
		// Layer 1 (left) - moves to center and stacks at bottom
		tl.to(layer1, {
			x: 0,
			y: 40,
			z: -40,
			scale: 0.95,
			opacity: 0.8,
			duration: 1,
			ease: 'power2.inOut',
		}, 0);
		
		// Layer 2 (center) - moves slightly back and stacks in middle
		tl.to(layer2, {
			x: 0,
			y: 20,
			z: -20,
			scale: 0.97,
			opacity: 0.9,
			duration: 1,
			ease: 'power2.inOut',
		}, 0.2);
		
		// Layer 3 (right) - moves to center and stacks on top
		tl.to(layer3, {
			x: 0,
			y: 0,
			z: 0,
			scale: 1.0,
			opacity: 1.0,
			duration: 1,
			ease: 'power2.inOut',
		}, 0.4);
		
		console.log('Animation timeline created');
		
		// Refresh ScrollTrigger on resize
		window.addEventListener('resize', () => {
			ScrollTrigger.refresh();
			console.log('ScrollTrigger refreshed on resize');
		});
	}
	
	// Initialize when DOM is ready
	function startAnimation() {
		requestAnimationFrame(() => {
			requestAnimationFrame(() => {
				initLayerStackingAnimation();
			});
		});
	}
	
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', startAnimation);
	} else {
		startAnimation();
	}
	
	// View Transitions support
	document.addEventListener('astro:after-swap', () => {
		console.log('View transition complete, re-initializing GSAP animation');
		// Kill existing ScrollTriggers to prevent duplicates
		ScrollTrigger.getAll().forEach(trigger => trigger.kill());
		startAnimation();
	});
</script>

<style>
	.layer-card {
		will-change: transform, opacity;
		backface-visibility: hidden;
		perspective: 1000px;
		left: 50%;
		top: 50%;
		transform-style: preserve-3d;
	}
	
	#layer-container {
		perspective: 1200px;
		transform-style: preserve-3d;
		position: relative;
	}
	
</style>
