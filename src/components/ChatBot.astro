---
// src/components/ChatBot.astro
---
<div id="chat-container" class="p-4 border rounded-lg bg-white shadow">
    <div id="messages" class="h-64 overflow-y-auto mb-4 space-y-2"></div>
    <form id="chat-form" class="flex gap-2">
      <input type="text" name="question" placeholder="Ask about this site..." class="flex-1 border p-2 rounded" required />
      <button type="submit" class="bg-black text-white px-4 py-2 rounded">Send</button>
    </form>
  </div>
  
  <script>
    import { actions } from 'astro:actions';
  
    const form = document.querySelector('#chat-form') as HTMLFormElement;
    const messagesDiv = document.querySelector('#messages')!;
  
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const question = formData.get('question') as string;
  
      // Add user message to UI
      messagesDiv.innerHTML += `<p><strong>You:</strong> ${question}</p>`;
      
      // Call the Astro Action
      const { data, error } = await actions.askChatbot({ question });
  
      if (data) {
        messagesDiv.innerHTML += `<p><strong>AI:</strong> ${data}</p>`;
      } else {
        messagesDiv.innerHTML += `<p class="text-red-500">Error: ${error.message}</p>`;
      }
      form.reset();
    });
  </script>